---
phase: 05-gap-closure
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - src/graph/traversal.ts
  - src/layout/elk-path.ts
  - src/store/viewer-store.ts
  - src/components/ResizeHandle.tsx
  - src/canvas/FgaGraph.tsx
  - src/types.ts
autonomous: true
requirements:
  - INT-05

must_haves:
  truths:
    - "No dead exported functions exist in traversal.ts (expandViaTtu, computeDepthLayers, findPaths, collectPathElements removed)"
    - "No dead exported functions exist in elk-path.ts (getPathMidpoint, getPathMidpointWithOffset, trimPathToHandles, NodeBounds removed)"
    - "No path tracing state exists in viewer-store.ts (pathStart, pathEnd, tracedPaths, tracedNodeIds, tracedEdgeIds, setPathStart, setPathEnd, tracePath, clearPath removed)"
    - "No editorWidth state exists in viewer-store.ts (editorWidth, setEditorWidth, EDITOR_WIDTH_KEY, DEFAULT_EDITOR_WIDTH, MIN_EDITOR_WIDTH, MAX_EDITOR_WIDTH_RATIO, loadPersistedEditorWidth removed)"
    - "ResizeHandle.tsx is deleted"
    - "No console.log calls exist in FgaGraph.tsx or viewer-store.ts"
    - "FocusMode type no longer includes 'path' variant"
    - "Build and lint pass clean"
  artifacts:
    - path: "src/graph/traversal.ts"
      provides: "Only live traversal functions remain (traceUpstream, traceDownstream, computeNeighborhood)"
    - path: "src/layout/elk-path.ts"
      provides: "Only elkPointsToPath and Point type remain (consumed by DimensionEdge)"
    - path: "src/store/viewer-store.ts"
      provides: "Clean store with no dead path tracing state or editorWidth state"
    - path: "src/canvas/FgaGraph.tsx"
      provides: "No debug console.log calls"
    - path: "src/types.ts"
      provides: "FocusMode = 'overview' | 'neighborhood' (no 'path')"
  key_links:
    - from: "src/store/viewer-store.ts"
      to: "src/graph/traversal.ts"
      via: "imports traceUpstream, traceDownstream, computeNeighborhood (must remain)"
      pattern: "import.*traceUpstream|traceDownstream|computeNeighborhood"
    - from: "src/canvas/edges/DimensionEdge.tsx"
      to: "src/layout/elk-path.ts"
      via: "imports elkPointsToPath and Point (must remain)"
      pattern: "import.*elkPointsToPath|Point"
---

<objective>
Remove all dead code identified in the v1.0 audit: orphaned traversal functions, dead elk-path helpers, unused path tracing store state, defunct ResizeHandle component, and debug console.log calls.

Purpose: Clean codebase for v1.0 milestone. Every removed item was verified via grep to have zero external consumers.

Output: Smaller, cleaner codebase with no dead code. Build and lint pass clean.
</objective>

<execution_context>
@/Users/thedoc/.claude/get-shit-done/workflows/execute-plan.md
@/Users/thedoc/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/05-gap-closure/05-RESEARCH.md
@src/graph/traversal.ts
@src/layout/elk-path.ts
@src/store/viewer-store.ts
@src/components/ResizeHandle.tsx
@src/canvas/FgaGraph.tsx
@src/types.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Remove dead traversal and elk-path functions</name>
  <files>src/graph/traversal.ts, src/layout/elk-path.ts</files>
  <action>
**traversal.ts -- remove these 4 dead functions (zero external consumers confirmed via grep):**

1. `expandViaTtu()` (starts at line 143) -- replaced by dimension-aware hover tracing in hover-store during Phase 1
2. `findPaths()` (starts at line 57) -- part of dropped PATH-01/PATH-02 features
3. `collectPathElements()` (starts at line 104) -- part of dropped PATH-01/PATH-02 features
4. `computeDepthLayers()` (starts at line 345) -- replaced by ELK's internal layering algorithm in Phase 1

After removal, verify that these functions REMAIN (they have live consumers):
- `traceUpstream()` -- used by hover-store
- `traceDownstream()` -- used by hover-store
- `computeNeighborhood()` -- used by viewer-store's getVisibleGraph

Also remove any imports that become unused after deleting these functions (e.g., type imports only used by the deleted functions).

**elk-path.ts -- remove these 3 dead functions + 1 dead interface (zero external consumers confirmed via grep):**

1. `getPathMidpoint()` (starts at line 63) -- zero imports
2. `getPathMidpointWithOffset()` (starts at line 101) -- zero imports
3. `trimPathToHandles()` (starts at line 170) -- zero imports
4. `NodeBounds` interface (starts at line 159) -- only used by trimPathToHandles

After removal, verify that these REMAIN (they have live consumers):
- `elkPointsToPath()` -- imported by DimensionEdge.tsx
- `Point` type -- imported by DimensionEdge.tsx and elk-layout.ts
  </action>
  <verify>
1. `grep -r "expandViaTtu\|computeDepthLayers\|findPaths\|collectPathElements" src/` returns only zero matches
2. `grep -r "getPathMidpoint\|getPathMidpointWithOffset\|trimPathToHandles\|NodeBounds" src/` returns zero matches
3. `grep -r "traceUpstream\|traceDownstream\|computeNeighborhood" src/` still shows live imports
4. `grep -r "elkPointsToPath" src/` still shows live imports
5. `npm run build` passes clean
  </verify>
  <done>All dead functions removed from traversal.ts and elk-path.ts. Only live functions remain. Build passes.</done>
</task>

<task type="auto">
  <name>Task 2: Remove dead store state, delete ResizeHandle, remove console.log, clean FocusMode</name>
  <files>src/store/viewer-store.ts, src/components/ResizeHandle.tsx, src/canvas/FgaGraph.tsx, src/types.ts</files>
  <action>
**viewer-store.ts -- remove dead path tracing state (all references are internal to the store, zero external consumers):**

1. Remove imports: `findPaths` and `collectPathElements` from `"../graph/traversal"` (line 20-21)
2. Remove constants: `EDITOR_WIDTH_KEY` (line 30), `DEFAULT_EDITOR_WIDTH` (line 32), `MIN_EDITOR_WIDTH` (line 33), `MAX_EDITOR_WIDTH_RATIO` (line 34)
3. Remove function: `loadPersistedEditorWidth()` (lines 39-44)
4. Remove interface fields: `pathStart`, `pathEnd`, `tracedPaths`, `tracedNodeIds`, `tracedEdgeIds` (lines 96-100), `editorWidth` (line 115)
5. Remove interface actions: `setPathStart`, `setPathEnd`, `tracePath`, `clearPath` (lines 130-133), `setEditorWidth` (line 153)
6. Remove initial state: `pathStart: null`, `pathEnd: null`, `tracedPaths: null`, `tracedNodeIds: null`, `tracedEdgeIds: null` (lines 176-180), `editorWidth: loadPersistedEditorWidth()` (line 189)
7. Remove reset blocks in `parse()` success path (lines 217-221) -- the 5 path fields being reset
8. Remove reset blocks in `parse()` error path (lines 237-241) -- the 5 path fields being reset
9. Remove reset blocks in `setFocusMode('overview')` (lines 271-275) -- the 5 path fields being reset
10. Remove action implementations: `setPathStart` (lines 285-293), `setPathEnd` (lines 295-303), `tracePath` (lines 305-312), `clearPath` (lines 313-321), `setEditorWidth` (lines 429-432)

**IMPORTANT:** After each removal, check the surrounding code to ensure no dangling commas, missing properties in `set()` calls, or broken destructuring. The path fields appear in several `set()` calls alongside other fields (like `focusMode`, `navigationStack`) that must REMAIN.

**Delete ResizeHandle.tsx:**
Delete the entire file `src/components/ResizeHandle.tsx`. It has zero imports from any other file (confirmed via grep). It imports `DEFAULT_EDITOR_WIDTH` and `setEditorWidth` from viewer-store, which we are also removing above.

**FgaGraph.tsx -- remove ALL console.log calls:**
There are 12 `console.log` calls in FgaGraph.tsx used for transition/layout debugging. Remove every single one. These are development artifacts. Do NOT remove any actual logic -- only the console.log statements and any lines that exist solely to construct log arguments.

**viewer-store.ts -- remove ALL console.log calls:**
There are 4 `console.log` calls in viewer-store.ts used for subgraph navigation debugging. Remove every single one.

**types.ts -- remove "path" from FocusMode:**
Change `export type FocusMode = "overview" | "neighborhood" | "path"` to `export type FocusMode = "overview" | "neighborhood"`. The "path" variant was only set by `setPathStart`/`setPathEnd` which are dead code being removed above.
  </action>
  <verify>
1. `grep -r "pathStart\|pathEnd\|tracedPaths\|tracedNodeIds\|tracedEdgeIds\|setPathStart\|setPathEnd\|tracePath\|clearPath" src/` returns zero matches
2. `grep -r "editorWidth\|EDITOR_WIDTH_KEY\|DEFAULT_EDITOR_WIDTH\|MIN_EDITOR_WIDTH\|MAX_EDITOR_WIDTH_RATIO\|loadPersistedEditorWidth\|setEditorWidth" src/` returns zero matches
3. `grep -r "ResizeHandle" src/` returns zero matches
4. `grep -r "console\.log" src/canvas/FgaGraph.tsx src/store/viewer-store.ts` returns zero matches
5. `grep "path" src/types.ts` confirms FocusMode no longer includes "path"
6. `npm run build` passes clean
7. `npm run lint` passes clean
  </verify>
  <done>All dead store state removed. ResizeHandle.tsx deleted. All console.log calls removed from FgaGraph.tsx and viewer-store.ts. FocusMode cleaned to "overview" | "neighborhood". Build and lint pass clean.</done>
</task>

</tasks>

<verification>
- `npm run build` passes with zero errors
- `npm run lint` passes with zero warnings/errors
- `grep -r "expandViaTtu\|computeDepthLayers\|findPaths\|collectPathElements" src/` returns zero matches
- `grep -r "getPathMidpoint\|getPathMidpointWithOffset\|trimPathToHandles\|NodeBounds" src/` returns zero matches
- `grep -r "pathStart\|pathEnd\|tracedPaths\|tracedNodeIds\|tracedEdgeIds" src/` returns zero matches
- `grep -r "editorWidth\|EDITOR_WIDTH_KEY\|DEFAULT_EDITOR_WIDTH\|setEditorWidth" src/` returns zero matches
- `grep -r "ResizeHandle" src/` returns zero matches
- `grep -r "console\.log" src/canvas/FgaGraph.tsx src/store/viewer-store.ts` returns zero matches
- FocusMode type is `"overview" | "neighborhood"` with no "path"
</verification>

<success_criteria>
All dead code identified in the v1.0 audit is removed. No orphaned functions, no unused store state, no dead components, no debug logging. Build and lint pass clean. Live code (traceUpstream, traceDownstream, computeNeighborhood, elkPointsToPath, neighborhood focus mode) remains untouched.
</success_criteria>

<output>
After completion, create `.planning/phases/05-gap-closure/05-02-SUMMARY.md`
</output>
